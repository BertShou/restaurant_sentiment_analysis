# 餐饮评论细粒度情感分析

## 项目概述
本项目实现了一个基于BiLSTM和注意力机制的细粒度情感分析模型，用于分析餐饮评论中的多个方面（如位置、服务、价格、环境、食物等）的情感极性。模型能够识别四种不同的情感状态：正面(1)、中性(0)、负面(-1)和未提及(-2)，提供更加细粒度的情感分析结果。

## 环境要求
- Python 3.6+
- PyTorch
- pandas
- numpy
- jieba
- scikit-learn
- matplotlib
- seaborn
- tqdm

## 数据集
数据集包含餐饮评论及其对应的18个细粒度方面的情感标签：
- 位置相关：交通、市中心位置、易找程度
- 服务相关：排队、服务态度、停车、及时性
- 价格相关：价格水平、性价比、折扣
- 环境相关：装修、噪音、空间、卫生
- 食物相关：分量、口味、外观、推荐度

情感标签采用四级标注：
- 1：正面评价
- 0：中性评价
- -1：负面评价
- -2：未提及该方面

数据集分为：
- train.csv：训练集
- dev.csv：验证集
- test.csv：测试集

## 模型架构
- 词嵌入层：将文本转换为300维的向量表示
- BiLSTM层：捕获文本的双向上下文信息
- 注意力层：自适应加权重要特征
- 全连接层：输出18个方面的情感极性预测
- 标签映射：将模型输出映射到四种情感状态
  - 0.0 → -2（未提及）
  - 0.25 → -1（负面）
  - 0.5 → 0（中性）
  - 1.0 → 1（正面）

## 使用说明

### 1. 环境配置
```bash
pip install torch pandas numpy jieba scikit-learn matplotlib seaborn tqdm
```

### 2. 训练模型
```bash
python analysis.py
```

### 3. 模型输出
- best_model.pth：保存验证集上F1分数最高的模型
- metrics_curves.png：展示各项评估指标的变化趋势
- training_curves.png：展示训练过程中的损失变化

## 实验结果
- 模型在测试集上的表现详见analysis_report_analysis.md
- 可视化结果包括：
  - 训练曲线
  - 各项指标变化趋势
  - 每个方面的性能指标

## 主要改进
相比try4版本的改进：
1. 添加了更详细的性能指标评估
   - 准确率（ACC）
   - 精确率（PPV）
   - 召回率（TPR）
   - 特异度（TNR）
   - F1分数
2. 优化了评估过程，添加了混淆矩阵分析
3. 改进了可视化展示，提供更直观的性能分析
4. 改进了标签处理方式：
   - 将原始标签(-2, -1, 0, 1)映射到合适的连续值(0.0, 0.25, 0.5, 1.0)
   - 使用MSELoss替代BCELoss，更适合多类别回归任务
   - 重新设计评估方法，能够准确识别四种不同的情感状态

## 文件说明
- [analysis.py](analysis.py)：主程序文件
- [plot_training_curves.py](plot_training_curves.py)：绘制训练曲线的工具函数  
- [analysis_report.md](analysis_report.md)：详细的模型评估报告
- [README.md](README.md)：项目说明文档

## 注意事项
1. 确保数据集文件位于正确的目录下
2. 训练过程中会自动保存最佳模型
3. 可以通过调整超参数优化模型性能
4. 标签映射是保持细粒度情感分析效果的关键部分