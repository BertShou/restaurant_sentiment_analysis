C:\graduate_course\software\anaconda3\envs\by\python.exe C:\graduate_course\projects\restaurant_sentiment_analysis\analysis.py
使用 GPU: NVIDIA RTX 2000 Ada Generation Laptop GPU
数据增强: 0it [00:00, ?it/s]Building prefix dict from the default dictionary ...
Loading model from cache C:\Users\SHOUY2~1\AppData\Local\Temp\jieba.cache
Loading model cost 0.443 seconds.
Prefix dict has been built successfully.
数据增强: 36850it [00:33, 1114.10it/s]
Training:   0%|          | 0/4109 [00:00<?, ?it/s]Building prefix dict from the default dictionary ...
Building prefix dict from the default dictionary ...
Loading model from cache C:\Users\SHOUY2~1\AppData\Local\Temp\jieba.cache
Building prefix dict from the default dictionary ...
Building prefix dict from the default dictionary ...
Loading model from cache C:\Users\SHOUY2~1\AppData\Local\Temp\jieba.cache
Loading model from cache C:\Users\SHOUY2~1\AppData\Local\Temp\jieba.cache
Loading model from cache C:\Users\SHOUY2~1\AppData\Local\Temp\jieba.cache
Loading model cost 0.529 seconds.
Prefix dict has been built successfully.
Loading model cost 0.716 seconds.
Prefix dict has been built successfully.
Loading model cost 0.723 seconds.
Prefix dict has been built successfully.
Loading model cost 0.734 seconds.
Prefix dict has been built successfully.
Training: 100%|██████████| 4109/4109 [02:11<00:00, 31.27it/s]
Batch processing time: 131409.31 ms
Building prefix dict from the default dictionary ...
Building prefix dict from the default dictionary ...
Building prefix dict from the default dictionary ...
Loading model from cache C:\Users\SHOUY2~1\AppData\Local\Temp\jieba.cache
Building prefix dict from the default dictionary ...
Loading model from cache C:\Users\SHOUY2~1\AppData\Local\Temp\jieba.cache
Loading model from cache C:\Users\SHOUY2~1\AppData\Local\Temp\jieba.cache
Loading model from cache C:\Users\SHOUY2~1\AppData\Local\Temp\jieba.cache
Loading model cost 0.534 seconds.
Prefix dict has been built successfully.
Loading model cost 0.549 seconds.
Prefix dict has been built successfully.
Loading model cost 0.552 seconds.
Prefix dict has been built successfully.
Loading model cost 0.554 seconds.
Prefix dict has been built successfully.

每个类别的性能指标：

Location#Transportation:
  准确率 (ACC): 0.9419
  精确率 (PPV): 0.9017
  灵敏度 (TPR): 0.7579
  特异度 (TNR): 0.9820
  F1分数: 0.8236

Location#Downtown:
  准确率 (ACC): 0.8962
  精确率 (PPV): 0.7682
  灵敏度 (TPR): 0.5470
  特异度 (TNR): 0.9667
  F1分数: 0.6390

Location#Easy_to_find:
  准确率 (ACC): 0.9429
  精确率 (PPV): 0.8981
  灵敏度 (TPR): 0.6812
  特异度 (TNR): 0.9870
  F1分数: 0.7748

Service#Queue:
  准确率 (ACC): 0.9528
  精确率 (PPV): 0.0000
  灵敏度 (TPR): 0.0000
  特异度 (TNR): 1.0000
  F1分数: 0.0000

Service#Hospitality:
  准确率 (ACC): 0.8059
  精确率 (PPV): 0.8404
  灵敏度 (TPR): 0.5671
  特异度 (TNR): 0.9397
  F1分数: 0.6772

Service#Parking:
  准确率 (ACC): 0.9648
  精确率 (PPV): 1.0000
  灵敏度 (TPR): 0.0169
  特异度 (TNR): 1.0000
  F1分数: 0.0333

Service#Timely:
  准确率 (ACC): 0.9417
  精确率 (PPV): 0.8114
  灵敏度 (TPR): 0.3577
  特异度 (TNR): 0.9927
  F1分数: 0.4965

Price#Level:
  准确率 (ACC): 0.8482
  精确率 (PPV): 0.7115
  灵敏度 (TPR): 0.0932
  特异度 (TNR): 0.9928
  F1分数: 0.1648

Price#Cost_effective:
  准确率 (ACC): 0.8575
  精确率 (PPV): 0.7467
  灵敏度 (TPR): 0.2629
  特异度 (TNR): 0.9814
  F1分数: 0.3889

Price#Discount:
  准确率 (ACC): 0.9111
  精确率 (PPV): 0.8384
  灵敏度 (TPR): 0.5127
  特异度 (TNR): 0.9823
  F1分数: 0.6363

Ambience#Decoration:
  准确率 (ACC): 0.8500
  精确率 (PPV): 0.8347
  灵敏度 (TPR): 0.7113
  特异度 (TNR): 0.9244
  F1分数: 0.7681

Ambience#Noise:
  准确率 (ACC): 0.8597
  精确率 (PPV): 0.7772
  灵敏度 (TPR): 0.5275
  特异度 (TNR): 0.9561
  F1分数: 0.6284

Ambience#Space:
  准确率 (ACC): 0.8451
  精确率 (PPV): 0.7568
  灵敏度 (TPR): 0.5052
  特异度 (TNR): 0.9499
  F1分数: 0.6059

Ambience#Sanitary:
  准确率 (ACC): 0.8561
  精确率 (PPV): 0.8229
  灵敏度 (TPR): 0.5916
  特异度 (TNR): 0.9532
  F1分数: 0.6883

Food#Portion:
  准确率 (ACC): 0.7587
  精确率 (PPV): 0.6827
  灵敏度 (TPR): 0.1325
  特异度 (TNR): 0.9784
  F1分数: 0.2219

Food#Taste:
  准确率 (ACC): 0.6775
  精确率 (PPV): 0.7471
  灵敏度 (TPR): 0.5761
  特异度 (TNR): 0.7878
  F1分数: 0.6506

Food#Appearance:
  准确率 (ACC): 0.8184
  精确率 (PPV): 0.5625
  灵敏度 (TPR): 0.0200
  特异度 (TNR): 0.9965
  F1分数: 0.0386

Food#Recommend:
  准确率 (ACC): 0.8599
  精确率 (PPV): 0.2857
  灵敏度 (TPR): 0.0029
  特异度 (TNR): 0.9988
  F1分数: 0.0057

平均性能指标：
平均准确率 (ACC): 0.8660
平均精确率 (PPV): 0.7215
平均灵敏度 (TPR): 0.3813
平均特异度 (TNR): 0.9650
平均F1分数: 0.4579

Epoch 1/1
Train Loss: 0.3698
Val Loss: 0.3431
Learning Rate: 0.001000
Building prefix dict from the default dictionary ...
Building prefix dict from the default dictionary ...
Building prefix dict from the default dictionary ...
Building prefix dict from the default dictionary ...
Loading model from cache C:\Users\SHOUY2~1\AppData\Local\Temp\jieba.cache
Loading model from cache C:\Users\SHOUY2~1\AppData\Local\Temp\jieba.cache
Loading model from cache C:\Users\SHOUY2~1\AppData\Local\Temp\jieba.cache
Loading model from cache C:\Users\SHOUY2~1\AppData\Local\Temp\jieba.cache
Loading model cost 0.546 seconds.
Prefix dict has been built successfully.
Loading model cost 0.573 seconds.
Prefix dict has been built successfully.
Loading model cost 0.584 seconds.
Prefix dict has been built successfully.
Loading model cost 0.588 seconds.
Prefix dict has been built successfully.

每个类别的性能指标：

Location#Transportation:
  准确率 (ACC): 0.9401
  精确率 (PPV): 0.8868
  灵敏度 (TPR): 0.7532
  特异度 (TNR): 0.9796
  F1分数: 0.8145

Location#Downtown:
  准确率 (ACC): 0.8941
  精确率 (PPV): 0.7504
  灵敏度 (TPR): 0.5473
  特异度 (TNR): 0.9636
  F1分数: 0.6330

Location#Easy_to_find:
  准确率 (ACC): 0.9445
  精确率 (PPV): 0.8835
  灵敏度 (TPR): 0.6891
  特异度 (TNR): 0.9854
  F1分数: 0.7743

Service#Queue:
  准确率 (ACC): 0.9490
  精确率 (PPV): 0.0000
  灵敏度 (TPR): 0.0000
  特异度 (TNR): 1.0000
  F1分数: 0.0000

Service#Hospitality:
  准确率 (ACC): 0.7968
  精确率 (PPV): 0.8054
  灵敏度 (TPR): 0.5529
  特异度 (TNR): 0.9281
  F1分数: 0.6557

Service#Parking:
  准确率 (ACC): 0.9640
  精确率 (PPV): 1.0000
  灵敏度 (TPR): 0.0378
  特异度 (TNR): 1.0000
  F1分数: 0.0729

Service#Timely:
  准确率 (ACC): 0.9470
  精确率 (PPV): 0.9042
  灵敏度 (TPR): 0.3804
  特异度 (TNR): 0.9965
  F1分数: 0.5355

Price#Level:
  准确率 (ACC): 0.8591
  精确率 (PPV): 0.6744
  灵敏度 (TPR): 0.0799
  特异度 (TNR): 0.9934
  F1分数: 0.1429

Price#Cost_effective:
  准确率 (ACC): 0.8557
  精确率 (PPV): 0.7043
  灵敏度 (TPR): 0.2213
  特异度 (TNR): 0.9816
  F1分数: 0.3367

Price#Discount:
  准确率 (ACC): 0.9166
  精确率 (PPV): 0.8255
  灵敏度 (TPR): 0.5249
  特异度 (TNR): 0.9816
  F1分数: 0.6417

Ambience#Decoration:
  准确率 (ACC): 0.8460
  精确率 (PPV): 0.7982
  灵敏度 (TPR): 0.7135
  特异度 (TNR): 0.9112
  F1分数: 0.7535

Ambience#Noise:
  准确率 (ACC): 0.8619
  精确率 (PPV): 0.7504
  灵敏度 (TPR): 0.5149
  特异度 (TNR): 0.9544
  F1分数: 0.6107

Ambience#Space:
  准确率 (ACC): 0.8512
  精确率 (PPV): 0.7074
  灵敏度 (TPR): 0.5048
  特异度 (TNR): 0.9440
  F1分数: 0.5892

Ambience#Sanitary:
  准确率 (ACC): 0.8617
  精确率 (PPV): 0.7897
  灵敏度 (TPR): 0.5860
  特异度 (TNR): 0.9500
  F1分数: 0.6727

Food#Portion:
  准确率 (ACC): 0.7700
  精确率 (PPV): 0.7667
  灵敏度 (TPR): 0.1456
  特异度 (TNR): 0.9848
  F1分数: 0.2447

Food#Taste:
  准确率 (ACC): 0.6785
  精确率 (PPV): 0.7410
  灵敏度 (TPR): 0.5822
  特异度 (TNR): 0.7819
  F1分数: 0.6521

Food#Appearance:
  准确率 (ACC): 0.8140
  精确率 (PPV): 0.5185
  灵敏度 (TPR): 0.0152
  特异度 (TNR): 0.9968
  F1分数: 0.0296

Food#Recommend:
  准确率 (ACC): 0.8593
  精确率 (PPV): 0.2500
  灵敏度 (TPR): 0.0014
  特异度 (TNR): 0.9993
  F1分数: 0.0029

平均性能指标：
平均准确率 (ACC): 0.8672
平均精确率 (PPV): 0.7087
平均灵敏度 (TPR): 0.3806
平均特异度 (TNR): 0.9629
平均F1分数: 0.4535

测试集性能：
Test Loss: 0.3382

=== 模型性能评价总结 ===

1. 整体表现：
模型整体表现一般，平均F1分数为0.4535

2. 各项指标分析：
- 准确率：0.8672 (反映模型的整体预测准确性)
- 精确率：0.7087 (反映模型预测为正例的可信度)
- 召回率：0.3806 (反映模型捕获正例的能力)
- 特异度：0.9629 (反映模型识别负例的能力)

3. 模型特点：
- 模型倾向于保守预测，假阳性率较低

4. 改进建议：
- 考虑增加训练数据或优化模型结构
- 可能需要调整类别权重以处理数据不平衡

Process finished with exit code 0
